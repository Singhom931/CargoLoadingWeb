<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Container List</title>
    <script src="https://cdn.jsdelivr.net/npm/three@0.152.0/build/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.152.0/examples/js/particles/ParticleSystem.js"></script>
    <style>
      /* General Reset */
      body, html {
        margin: 0;
        padding: 0;
        font-family: 'Arial', sans-serif;
        /*background-color: #f4f4f9;*/
        color: #333;
        height: 100%;
        overflow-x: hidden;
    }

    h2 {
        display: inline-block;
        margin: 20px auto;
        text-align: center;
        font-family: 'Arial', sans-serif;
        font-size: 2.0rem;
        font-weight: bold;
        color: white;
        background: linear-gradient(90deg, #6a11cb, #1c5dcb, #6a11cb);
        padding: 10px 25px;
        border-radius: 10px;
        box-shadow: 0 6px 10px rgba(0, 0, 0, 0.3);
        animation: glow 3s infinite;
    }

    

    table {
        /*background:  linear-gradient(90deg, #54096d, #90276d, #54096d, #90276d, #54096d, #90276d, #54096d, #90276d, #54096d, #90276d, #54096d, #90276d, #54096d);
        */
        width: 100%;
        border-collapse: collapse;
        margin: 0 auto;
        table-layout: fixed; /* Ensures fixed column layout */
        /* background-color: #ddd; */
        backdrop-filter: blur(6px); /* blurs the 3D canvas behind */
        -webkit-backdrop-filter: blur(6px);
        box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
        /*z-index: 1;*/
        }
        
    thead{
        background:  linear-gradient(0deg, #90276d, #81206D, #90276d);

    }

    tbody {
        background-color: rgba(255, 255, 255, 0.5); /* Semi-transparent rows */
        color: #000;
    }

    th, td {
        padding: 12px;
        text-align: left;
        border-bottom: 1px solid #ddd;
        word-wrap: break-word; /* Prevents long words from overflowing */
    }

    th {
        /*background:  linear-gradient(90deg, #c316da, #e0109b, #bd1df2);/*#4CAF50;*/
        color: white;
        font-size: 1.1rem;
    }

    td {
      transition: background-color 0.3s ease;
      /* background-color: #f9f9f9; */
      font-size: 1rem;
    }

    table {
      border-collapse: collapse;
      width: 100%;
      table-layout: fixed;
    }

    td, th {
    padding: 4px 6px;
    text-align: center;
    vertical-align: middle;
    }

    td input,
    td select,
    td label {
    width: 100%;
    height: 100%;
    border: none;
    background: transparent;
    padding: 2px;
    font: inherit;
    box-sizing: border-box;
    text-align: center;
    }

    td input:focus {
    outline: none;
    background-color: #eef; /* optional focus style */
    }

    td input[type="color"] {
    padding: 0;
    width: 100%;
    height: 30px;
    border: none;
    }

    td input[type="checkbox"] {
    transform: scale(1.2);
    margin: 0 auto;
    display: block;
    }

    td label {
    display: block;
    font-size: 0.8em;
    }

    tr:hover td {
        background-color: #f1f1f1;
    }

    .delete-btn {
        cursor: pointer;
        color: red;
    }

    input[type="text"], input[type="color"] {
        width: 100%; /* Allow inputs to stretch within their column */
        box-sizing: border-box; /* Prevents input from overflowing */
    }

    /* Fix Table Layout */
    table {
        width: 80%;
        display: table;  /* Ensure it's a table, not a grid */
    }

    th:nth-child(1), td:nth-child(1) { width: 4vw; }
    th:nth-child(2), td:nth-child(2) { width: 2.25vw; }
    th:nth-child(3), td:nth-child(3) { width: 2.25vw; }
    th:nth-child(4), td:nth-child(4) { width: 2.25vw; }
    th:nth-child(5), td:nth-child(5) { width: 2.25vw; }
    th:nth-child(6), td:nth-child(6) { width: 2.25vw; }
    th:nth-child(7), td:nth-child(7) { width: 1.75vw; }

    /* Ensure delete button has proper alignment */
    .delete-btn {
      font-size: 1.2rem;
      cursor: pointer;
      color: red;
    }

    @media (max-width: 768px) {
        table {
            grid-template-columns: repeat(6, 1fr); /* Make the table more compact on small screens */
        }
        th, td {
            font-size: 0.9rem;
        }
    }

    button {
      width: 90%;
      padding: 15px;
      margin: 20px 0;
      border: none;
      border-radius: 8px;
      background: linear-gradient(90deg, #c316da, #e0109b, #bd1df2);
      color: white;
      font-size: 1.2em;
      font-weight: bold;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    button:hover {
        background: linear-gradient(90deg, #e0109b, #c316da, #e0109b);
    }

    #playBtn {
        position: absolute;
        top: -2vh;
        left: 175vb;
        width: 30vb;
        background-color: #4CAF50;
        color: white;
        padding: 10px 20px;
        border-radius: 5px;
        cursor: pointer;
    }

    #backBtn {
      position: relative;
      top: 0%;
      left: 10%;
      width: 15%;
      background-color: #4CAF50;
      color: white;
      padding: 10px 10px;
      border-radius: 5px;
      cursor: pointer;
  }

    #nextBtn {
        position: relative;
        top: 0%;
        left: 60%;
        width: 15%;
        background-color: #4CAF50;
        color: white;
        padding: 10px 10px;
        border-radius: 5px;
        cursor: pointer;
    }

    #addBtn {
        position: relative;
        top: 0vh;
        left: 10%;
        width: 80%;
        margin-bottom: 0.1%rem;
        background-color: #4CAF50;
        color: white;
        padding: 10px 20px;
        border-radius: 5px;
        cursor: pointer;
    }

    #webgl-canvas {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        z-index: -1;
        /* filter: blur(3px); */
    }

    #container-form {
        position: fixed;
        top: 20px;
        left: 20px;
        background-color: rgba(255, 255, 255, 0.8);
        padding: 20px;
        border-radius: 10px;
        /*z-index: -1;*/
    }
    #container-form input, #container-form select, #container-form button {
        margin-bottom: 10px;
        padding: 5px;
    }
    </style>
  </head>
  <body onload="addRow()">
    <h2 id="containertitle">Container List</h2>

    <canvas id="webgl-canvas"></canvas>

    <!-- container form for user input -->
<div id="container-form">
  <label for="container-name">Container Name:</label>
  <input type="text" id="container-name" placeholder="Enter Container name"><br>

  <label for="container-length">Length (cm):</label>
  <input type="number" id="container-length" value="1"><br>

  <label for="container-width">Width (cm):</label>
  <input type="number" id="container-width" value="1"><br>

  <label for="container-height">Height (cm):</label>
  <input type="number" id="container-height" value="1"><br>

  <label for="container-weight">Weight (kg):</label>
  <input type="number" id="container-weight-capacity" value="1"><br>

  <button id="add-container">Add container</button>
</div>


    <table id="containerTable" border="2">
      <thead>
        <tr>
          <th>Container Name</th>
          <th>Length (cm)</th>
          <th>Width (cm)</th>
          <th>Height (cm)</th>
          <th>Volume (cm³)</th>
          <th>Weight Capacity (kg)</th>
          <th>‎ ‎ ‎ Actions</th>
        </tr>
      </thead>
      <tbody id="main-table">
        <!-- Rows will be added here dynamically -->
      </tbody>
    </table>

    <button id="backBtn" onclick="window.history.back()">Back</button>

    <button type="submit" id="nextBtn" onclick="window.location.href='load_output';submitContainer()">Next</button>
    <style>
      .split-text-button {
      display: flex;
      width: 100%;
      height: 60px;
      /* background-color: #2c3e50; */
      color: white;
      border: none;
      border-radius: 10px;
      /* overflow: hidden; */
      cursor: pointer;
      font-family: sans-serif;
      pointer-events: none;
    }
      .split-half {
      flex: 1;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 10px;
      text-align: center;
      font-size: 24px;
      transition: background 0.2s;
      border: 4px solid rgba(255, 255, 255, 0.75);
      pointer-events: none;
    }
    .split-half:hover {
      background-color: rgba(255, 255, 255, 0.05);
    }
    .split-half:first-child{
      margin-right: 20px
    }

    </style>
    <button id="addBtn" onclick="handleSplitClick(event, this)"><div style="font-size: 26px; font-weight: bold;margin-top: 7.5px; margin-bottom: 12.5px; pointer-events: none;">Add Containers From Below Table</div><div class="split-text-button" style="font-size: 24px; font-weight: normal; opacity: 0.8;"> <div class="split-half">Click Here to Show/Hide Below Table</div><div class="split-half">Click here to Add Blank Row To Above Table</div></div></button>

    <button id="playBtn">Play</button>

    <table id="defaultcontainersTable" border="2">
      <thead>
        <tr>
          <th>Container Name</th>
          <th>Length (cm)</th>
          <th>Width (cm)</th>
          <th>Height (cm)</th>
          <th>Volume (cm³)</th>
          <th>Weight Capacity (kg)</th>
          <th>‎ ‎ ‎ Actions</th>
        </tr>
      </thead>
      <tbody id="default-containers">
        
      </tbody>
    </table>
    <script>
      const data_ = [
        ["Container - 20' DC", 589.8, 235.2, 239.3, 28200],
        ["Container - 20' HC Pallet Wide", 590, 243, 269, 28000],
        ["Container - 20' Reefer", 545.1, 229, 225.4, 27490],
        ["Container - 40' DC", 1203.5, 235.2, 239.3, 28800],
        ["Container - 40' HC", 1203.5, 235.2, 269.5, 28620],
        ["Container - 40' HC Pallet Wide", 1210, 243, 269, 29370],
        ["Container - 40' HC Reefer", 1157.7, 229, 249.8, 28350],
        ["Container - 40' Reefer", 1157.7, 229, 225.4, 28600],
        ["Container - 45' HC", 1355.6, 235.2, 269.5, 27600],
        ["Container - 45' HC Pallet Wide", 1355, 243, 269, 29140],
        ["Pallet - EPAL CP5 (76x114cm)", 114, 76, 200, 1000],
        ["Pallet - EU - EPAL 1 (120x80cm)", 120, 80, 200, 1500],
        ["Pallet - EU - EPAL 2 (120x100cm)", 120, 100, 200, 1250],
        ["Pallet - EU - EPAL 6 (80x60cm)", 60, 80, 200, 1300],
        ["Pallet - US Standard", 121.921, 101.602, 203.202, 1133.981],
        ["Truck - America 28' Trailer", 830.583, 251.463, 279.403, 6123.497],
        ["Truck - America 48' Trailer", 1440.184, 251.463, 279.403, 6123.497],
        ["Truck - America 53' Trailer", 1600.205, 251.463, 279.403, 20411.657],
        ["Truck - Europe 13,6 Trailer - Curtain Mega", 1362, 248, 294, 32800],
        ["Truck - Europe 13,6 Trailer - Curtain Standard", 1362, 248, 270, 32800],
        ["Air - P6P/PMC pallet", 317.5, 242.8, 163, 6804]
      ]

      const data = data_.map(([name, l, w, h, w_cap]) => [name, l, w, h, l * w * h, w_cap]);


      const tbody = document.getElementById('default-containers');

      data.forEach(r => tbody.innerHTML += `<tr>${r.map(v =>
        `<td><input type="text" size="20" value="${v}" readonly></td>`
      ).join('')}<td><span class="addRow-btn" onclick="addRowtoTable(this)">‎ ‎ ‎ ‎ ‎ ‎ ➕</span></td></tr>`);
    </script>

    <!-- <script src="{{ url_for('static', filename='container.js') }}"></script> -->
    <script src="{{ url_for('static', filename='container3d.js') }}"></script>

    <script type="text/javascript">
      // Pass the existing_reference value from Flask into JavaScript

      const existingReference = {{ existing_reference | tojson }};

      // Now you can use the `existingReference` variable in JavaScript
      if (existingReference) {
          console.log("Reference exists: ", existingReference);
          fetchContainerData()
          // Perform any logic if the reference exists
      } else {
          console.log("No existing reference found.");
      }
    </script>
  </body>
</html>
